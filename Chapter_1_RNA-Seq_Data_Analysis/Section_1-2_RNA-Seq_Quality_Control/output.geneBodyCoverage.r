V1M_SRR9336474_Aligned.sortedByCoord.out <- c(0.0,0.11640574092329284,0.20338841456283102,0.2757096790362734,0.3322417336385357,0.38584986048687575,0.4313461763379058,0.48394345959131846,0.5216120031411338,0.553399274865917,0.5869910277188352,0.6146346761123457,0.634717882742143,0.6546089455481111,0.6709745868907787,0.6790696897294949,0.6935640173096523,0.7087433793921571,0.7175569330504085,0.7278073883477302,0.7285509014051561,0.7352842893184742,0.7420343853903861,0.7472891012681493,0.7512405807755927,0.7556014101685853,0.7605470251123624,0.7719169270354714,0.7780237590015204,0.7765785032831531,0.7780488212394112,0.7855674926066398,0.7871714758316486,0.780287714490986,0.782075487460527,0.7826602730113115,0.7836878247648327,0.778809042455431,0.7765534410452624,0.7756261382433042,0.7787672720589464,0.7842141317605387,0.7913819317972967,0.7944228166613757,0.7952081001152863,0.7990175602746822,0.8013065780020384,0.8045897311657282,0.8214900335833988,0.8316318858498605,0.8385490635077109,0.8417152595612437,0.8530016206913836,0.8615729060500242,0.8680723797430285,0.8672536799719303,0.8752318257004895,0.8739787138059515,0.8870277856677415,0.9022322099881372,0.9065930393811298,0.9174115720706421,0.923635361146848,0.9275032998613223,0.9320312108402533,0.9435598402700038,0.9474110708258843,0.9537100466157625,0.9632838214900336,0.9713956324873436,0.9767338891580759,0.9839100432741308,0.9797246495463735,0.9887637633456416,0.9960151041753689,0.9978697097792852,1.0,0.9979532505722545,0.9969089906601394,0.9999498755242184,0.9969256988187332,0.9977443985898314,0.9978028771449099,0.989791315099163,0.992631702060116,0.995046030976926,0.9841940819702261,0.9712703212978897,0.9602512907052514,0.9501679169938682,0.9290822208484403,0.9118226930210022,0.8896927369634593,0.8663597934871597,0.835792217339727,0.7862608811882842,0.739837262535296,0.676947753588077,0.609647290772084,0.534443868941204)
V1M_SRR9336471_Aligned.sortedByCoord.out <- c(0.0,0.15207997618778804,0.2627554424247401,0.35381662544006404,0.42380605363906027,0.4858101797206171,0.5438524463968634,0.600940171817426,0.648677498486077,0.6805673875334859,0.7157109279577949,0.7484835110695994,0.7711051124408543,0.7918381590696815,0.805212000533722,0.8122940808178263,0.8272998799125517,0.8394009997023474,0.8481253015016063,0.8588715885413993,0.859897976988371,0.8600211436020077,0.8683143622535384,0.86898151474407,0.8688480842459637,0.874267415245974,0.8770489279372672,0.8842336470660687,0.8894169087232754,0.8917673382668405,0.8859682435414507,0.8920855186854016,0.8942306705395724,0.8926808239846452,0.8982541132517012,0.898408071518747,0.8964784612384403,0.8956778782498024,0.8975459052232908,0.8930297960566156,0.8939330178899506,0.8950209896437405,0.8932042820926007,0.8989007379732934,0.898007780024428,0.8969198082706381,0.8963142390869249,0.8953802256001806,0.9026367919202701,0.9083845672233113,0.9078508452308861,0.908723275410812,0.9178889242422688,0.9225897833293989,0.9233903663180367,0.9267261287706946,0.9309240575188086,0.9315809461248704,0.9384577487195804,0.9441439407158033,0.9476028697820977,0.9523242566381673,0.9522318816779398,0.9531966868180932,0.9601556004885609,0.9683359164109249,0.9711790124090364,0.9746379414753308,0.9788153424545053,0.9834854098882263,0.9815557996079196,0.9873343665643699,0.9888431575814183,0.9912038510094531,0.9977830009545413,1.0,0.9971363762329492,0.998296195178027,0.995186238183703,0.9971876956552977,0.9910704205113468,0.9871290888749756,0.9855176590132302,0.973652608566238,0.9733549559166162,0.9768959960586684,0.971733262170401,0.9594166008067413,0.9487421609582363,0.9382319432612467,0.9232774635888699,0.909770191626723,0.8927424072914635,0.8729536380338503,0.8370095146209034,0.7906372845867247,0.7490377608309641,0.6909339108478995,0.6163565262909401,0.5276457728191811)
V1M_SRR9336468_Aligned.sortedByCoord.out <- c(0.0,0.1450595849884719,0.2522755261720233,0.34177801235219496,0.40794651703288054,0.47208718760706314,0.5288295045232738,0.5862848042075243,0.6313045732751835,0.6646110540107596,0.7023065455521913,0.731122160800763,0.7542061353556118,0.774058538663111,0.7891978480883728,0.7974017796790651,0.816068964878654,0.8337268627832255,0.8424678463290647,0.8572367750956045,0.8596535088937656,0.8638758484031964,0.873792790540478,0.877505856644166,0.8817281961535969,0.8876450271766808,0.8931266609257664,0.899524986805189,0.9026084057890497,0.9009139142753966,0.8975897478633665,0.903404724205302,0.9072103854736706,0.9032380529088772,0.9041825235886182,0.9051177347518913,0.9023861773938165,0.8966915747659657,0.8964323083048603,0.8945526264618462,0.8924044186412585,0.8953582043945665,0.896191560876691,0.8963952702389881,0.8923488615424503,0.8940340935396354,0.8947563358241433,0.8971545505893682,0.9101178736446383,0.9122475624322898,0.915432836097299,0.9084881987462615,0.9184792170152875,0.921710788262637,0.9240256673796494,0.924859023861774,0.928368380603165,0.9229978610516959,0.9333685194959119,0.9367667620396863,0.942831745326259,0.9454521884867172,0.9467485207922443,0.9469614896710093,0.9540820578349398,0.962980453160736,0.9646934637073252,0.9709065992573868,0.9793605377927165,0.9813235552839431,0.9806846486476476,0.9848977286406104,0.980953174625221,0.9907127049825458,0.998898117540302,0.9977406779817958,0.9970832523125642,0.9959721103363982,0.9936109336370454,0.9969073214996713,0.9954072798318472,0.997981425409965,1.0,0.9891478466994453,0.9942405807568728,0.9946942970638073,0.9868422270989009,0.9743789179329055,0.9612026259988703,0.9519894071131606,0.9361278554033908,0.9191644212339232,0.9022009870644555,0.8808763206385363,0.8470513069807495,0.7994944304008444,0.7574377066029612,0.6972323305276998,0.6274155763586026,0.5502930636962138)
data_matrix <- matrix(c(V1M_SRR9336474_Aligned.sortedByCoord.out,V1M_SRR9336471_Aligned.sortedByCoord.out,V1M_SRR9336468_Aligned.sortedByCoord.out), byrow=T, ncol=100)
rowLabel <- c("V1M_SRR9336474_Aligned.sortedByCoord.out","V1M_SRR9336471_Aligned.sortedByCoord.out","V1M_SRR9336468_Aligned.sortedByCoord.out")


pdf("output.geneBodyCoverage.heatMap.pdf")
rc <- cm.colors(ncol(data_matrix))
heatmap(data_matrix, scale=c("none"),keep.dendro=F, labRow = rowLabel ,Colv = NA,Rowv = NA,labCol=NA,col=cm.colors(256),margins = c(6, 8),ColSideColors = rc,cexRow=1,cexCol=1,xlab="Gene body percentile (5'->3')", add.expr=x_axis_expr <- axis(side=1,at=c(1,10,20,30,40,50,60,70,80,90,100),labels=c("1","10","20","30","40","50","60","70","80","90","100")))
dev.off()


pdf("output.geneBodyCoverage.curves.pdf")
x=1:100
icolor = colorRampPalette(c("#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"))(3)
plot(x,V1M_SRR9336474_Aligned.sortedByCoord.out,type='l',xlab="Gene body percentile (5'->3')", ylab="Coverage",lwd=0.8,col=icolor[1])
lines(x,V1M_SRR9336471_Aligned.sortedByCoord.out,type='l',col=icolor[2])
lines(x,V1M_SRR9336468_Aligned.sortedByCoord.out,type='l',col=icolor[3])
legend(0,1,fill=icolor[1:3], legend=c('V1M_SRR9336474_Aligned.sortedByCoord.out','V1M_SRR9336471_Aligned.sortedByCoord.out','V1M_SRR9336468_Aligned.sortedByCoord.out'))
dev.off()
